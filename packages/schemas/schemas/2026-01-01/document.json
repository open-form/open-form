{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schema.open-form.dev/2026-01-01/document.json",
  "type": "object",
  "properties": {
    "$schema": {
      "description": "JSON Schema URI for this artifact instance.",
      "type": "string",
      "format": "uri"
    },
    "name": {
      "description": "Unique artifact identifier. Must start with a letter or digit, can contain letters, numbers, and hyphens (no leading/trailing/consecutive hyphens).",
      "type": "string",
      "minLength": 1,
      "maxLength": 128,
      "pattern": "^[A-Za-z0-9]([A-Za-z0-9]|-[A-Za-z0-9])*$"
    },
    "version": {
      "description": "Artifact version (semantic versioning). Required for publishing to registry.",
      "type": "string",
      "minLength": 1,
      "maxLength": 200,
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
    },
    "title": {
      "description": "Human-readable title. Recommended for published/shared artifacts and directory browsing.",
      "type": "string",
      "minLength": 1,
      "maxLength": 200
    },
    "description": {
      "description": "Detailed description or context for the artifact.",
      "type": "string",
      "minLength": 0,
      "maxLength": 2000
    },
    "code": {
      "description": "Optional user-defined internal code.",
      "type": "string",
      "minLength": 1,
      "maxLength": 200
    },
    "releaseDate": {
      "description": "Artifact release date",
      "type": "string",
      "format": "date",
      "pattern": "^(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))$"
    },
    "metadata": {
      "description": "Custom key-value pairs for storing domain-specific or organizational metadata",
      "type": "object",
      "propertyNames": {
        "type": "string",
        "minLength": 1,
        "maxLength": 100,
        "pattern": "^[A-Za-z0-9]([A-Za-z0-9]|-[A-Za-z0-9])*$"
      },
      "additionalProperties": {
        "anyOf": [
          {
            "type": "string",
            "maxLength": 500
          },
          {
            "type": "number"
          },
          {
            "type": "boolean"
          },
          {
            "type": "null"
          }
        ]
      }
    },
    "kind": {
      "type": "string",
      "const": "document"
    },
    "layers": {
      "description": "Named layers for rendering this document into different formats. Keys are user-defined identifiers (e.g., markdown, pdf, html)",
      "type": "object",
      "propertyNames": {
        "description": "Layer identifier (user-defined key)",
        "type": "string",
        "minLength": 1,
        "maxLength": 100
      },
      "additionalProperties": {
        "$ref": "https://schema.open-form.dev/2026-01-01.json/$defs/Layer"
      }
    },
    "defaultLayer": {
      "description": "Key of the default layer to use when none specified at render time",
      "type": "string",
      "minLength": 1,
      "maxLength": 100
    }
  },
  "required": [
    "name",
    "kind"
  ],
  "additionalProperties": false,
  "id": "Document",
  "$defs": {
    "Layer": {
      "id": "Layer",
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "mimeType": {
              "description": "MIME type of the layer content (e.g., text/markdown, application/pdf)",
              "type": "string",
              "minLength": 1,
              "maxLength": 100
            },
            "title": {
              "description": "Human-readable title for this layer",
              "type": "string",
              "minLength": 1,
              "maxLength": 200
            },
            "description": {
              "description": "Description of what this layer represents",
              "type": "string",
              "minLength": 1,
              "maxLength": 2000
            },
            "checksum": {
              "description": "SHA-256 checksum for integrity verification",
              "type": "string",
              "minLength": 1,
              "maxLength": 100,
              "pattern": "^sha256:[a-f0-9]{64}$"
            },
            "bindings": {
              "description": "Mapping from form field names to template target identifiers",
              "type": "object",
              "propertyNames": {
                "description": "Form field name (semantic identifier)",
                "type": "string",
                "minLength": 1,
                "maxLength": 100
              },
              "additionalProperties": {
                "description": "Target identifier in the template",
                "type": "string",
                "minLength": 1,
                "maxLength": 500
              }
            },
            "kind": {
              "type": "string",
              "const": "inline"
            },
            "text": {
              "description": "Layer content with interpolation placeholders (e.g., {{fieldName}})",
              "type": "string",
              "minLength": 1,
              "maxLength": 1000000
            }
          },
          "required": [
            "mimeType",
            "kind",
            "text"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "mimeType": {
              "description": "MIME type of the layer content (e.g., text/markdown, application/pdf)",
              "type": "string",
              "minLength": 1,
              "maxLength": 100
            },
            "title": {
              "description": "Human-readable title for this layer",
              "type": "string",
              "minLength": 1,
              "maxLength": 200
            },
            "description": {
              "description": "Description of what this layer represents",
              "type": "string",
              "minLength": 1,
              "maxLength": 2000
            },
            "checksum": {
              "description": "SHA-256 checksum for integrity verification",
              "type": "string",
              "minLength": 1,
              "maxLength": 100,
              "pattern": "^sha256:[a-f0-9]{64}$"
            },
            "bindings": {
              "description": "Mapping from form field names to template target identifiers",
              "type": "object",
              "propertyNames": {
                "description": "Form field name (semantic identifier)",
                "type": "string",
                "minLength": 1,
                "maxLength": 100
              },
              "additionalProperties": {
                "description": "Target identifier in the template",
                "type": "string",
                "minLength": 1,
                "maxLength": 500
              }
            },
            "kind": {
              "type": "string",
              "const": "file"
            },
            "path": {
              "description": "Absolute path from repo root to the layer file",
              "type": "string",
              "minLength": 1,
              "maxLength": 1000
            }
          },
          "required": [
            "mimeType",
            "kind",
            "path"
          ],
          "additionalProperties": false
        }
      ]
    }
  },
  "title": "Document"
}