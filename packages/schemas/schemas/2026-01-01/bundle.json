{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schema.open-form.dev/2026-01-01/bundle.json",
  "title": "Bundle",
  "unevaluatedProperties": false,
  "description": "A bundle artifact that groups together related artifacts into a single distributable unit. Bundles can contain documents, forms, checklists, and other bundles.",
  "type": "object",
  "allOf": [
    {
      "title": "Artifact",
      "description": "Root schema for all OpenForm artifacts (containers and documents).",
      "type": "object",
      "properties": {
        "$schema": {
          "format": "uri",
          "description": "JSON Schema URI for this artifact instance.",
          "type": "string"
        },
        "name": {
          "description": "Unique artifact identifier. Must start with a letter or digit, can contain letters, numbers, and hyphens (no leading/trailing/consecutive hyphens).",
          "pattern": "^[A-Za-z0-9]([A-Za-z0-9]|-[A-Za-z0-9])*$",
          "minLength": 1,
          "maxLength": 128,
          "type": "string"
        },
        "version": {
          "description": "Artifact version (semantic versioning). Required for publishing to registry.",
          "minLength": 1,
          "maxLength": 200,
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
          "type": "string"
        },
        "title": {
          "description": "Human-readable title. Recommended for published/shared artifacts and directory browsing.",
          "minLength": 1,
          "maxLength": 200,
          "type": "string"
        },
        "description": {
          "description": "Detailed description or context for the artifact.",
          "minLength": 0,
          "maxLength": 2000,
          "type": "string"
        },
        "code": {
          "description": "Optional user-defined internal code.",
          "minLength": 1,
          "maxLength": 200,
          "type": "string"
        },
        "releaseDate": {
          "format": "date",
          "description": "Artifact release date",
          "type": "string"
        },
        "metadata": {
          "$ref": "https://schema.open-form.dev/2026-01-01.json#/$defs/Metadata"
        }
      },
      "required": [
        "name"
      ]
    },
    {
      "type": "object",
      "properties": {
        "kind": {
          "const": "bundle",
          "type": "string"
        },
        "logic": {
          "$ref": "https://schema.open-form.dev/2026-01-01.json#/$defs/LogicSection"
        },
        "contents": {
          "description": "Ordered bundle contents. Each item has a key and is either an inline artifact, path reference, or registry reference.",
          "minItems": 0,
          "type": "array",
          "items": {
            "description": "Bundle content item: an inline artifact, path reference, or registry reference with optional include condition",
            "anyOf": [
              {
                "additionalProperties": false,
                "type": "object",
                "properties": {
                  "type": {
                    "const": "inline",
                    "type": "string"
                  },
                  "key": {
                    "description": "Unique identifier for this content item, used to reference it in logic expressions",
                    "minLength": 1,
                    "maxLength": 100,
                    "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
                    "type": "string"
                  },
                  "artifact": {
                    "description": "Inline artifact definition (document, form, checklist, or nested bundle)",
                    "anyOf": [
                      {
                        "$ref": "https://schema.open-form.dev/2026-01-01.json#/$defs/Document"
                      },
                      {
                        "$ref": "https://schema.open-form.dev/2026-01-01.json#/$defs/Form"
                      },
                      {
                        "$ref": "https://schema.open-form.dev/2026-01-01.json#/$defs/Checklist"
                      },
                      {
                        "$ref": "https://schema.open-form.dev/2026-01-01.json#/$defs/Bundle"
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "key",
                  "artifact"
                ]
              },
              {
                "unevaluatedProperties": false,
                "type": "object",
                "allOf": [
                  {
                    "type": "object",
                    "properties": {
                      "key": {
                        "description": "Unique identifier for this content item, used to reference it in logic expressions",
                        "minLength": 1,
                        "maxLength": 100,
                        "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
                        "type": "string"
                      },
                      "include": {
                        "$ref": "https://schema.open-form.dev/2026-01-01.json#/$defs/CondExpr"
                      }
                    },
                    "required": [
                      "key"
                    ]
                  },
                  {
                    "type": "object",
                    "properties": {
                      "type": {
                        "const": "path",
                        "type": "string"
                      },
                      "path": {
                        "description": "Absolute path from repo root to the artifact file",
                        "minLength": 1,
                        "type": "string"
                      }
                    },
                    "required": [
                      "type",
                      "path"
                    ]
                  }
                ]
              },
              {
                "unevaluatedProperties": false,
                "type": "object",
                "allOf": [
                  {
                    "type": "object",
                    "properties": {
                      "key": {
                        "description": "Unique identifier for this content item, used to reference it in logic expressions",
                        "minLength": 1,
                        "maxLength": 100,
                        "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
                        "type": "string"
                      },
                      "include": {
                        "$ref": "https://schema.open-form.dev/2026-01-01.json#/$defs/CondExpr"
                      }
                    },
                    "required": [
                      "key"
                    ]
                  },
                  {
                    "type": "object",
                    "properties": {
                      "type": {
                        "const": "registry",
                        "type": "string"
                      },
                      "slug": {
                        "description": "Resource slug in format @org/repo/resource or @org/repo/resource@version",
                        "minLength": 1,
                        "type": "string"
                      }
                    },
                    "required": [
                      "type",
                      "slug"
                    ]
                  }
                ]
              }
            ]
          }
        }
      },
      "required": [
        "kind",
        "contents"
      ]
    }
  ]
}